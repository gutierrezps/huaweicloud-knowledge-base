<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/huaweicloud-knowledge-base/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/huaweicloud-knowledge-base/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(2) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(7) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(2) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/huaweicloud-knowledge-base/assets/js/vendor/lunr.min.js"></script> <script src="/huaweicloud-knowledge-base/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/huaweicloud-knowledge-base/assets/images/huawei-logo.png" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Bricked ECS After Migration Troubleshooting | Huawei Cloud Knowledge Base</title> <meta name="generator" content="Jekyll v4.4.1" /> <meta property="og:title" content="Bricked ECS After Migration Troubleshooting" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This blog is a knowledge base created in order to enable faster documentation sharing related to Huawei Cloud." /> <meta property="og:description" content="This blog is a knowledge base created in order to enable faster documentation sharing related to Huawei Cloud." /> <link rel="canonical" href="https://hatz-d.github.io/huaweicloud-knowledge-base/huaweicloud-knowledge-base/docs/migration/sms/bricked-ecs-after-migration-troubleshooting" /> <meta property="og:url" content="https://hatz-d.github.io/huaweicloud-knowledge-base/huaweicloud-knowledge-base/docs/migration/sms/bricked-ecs-after-migration-troubleshooting" /> <meta property="og:site_name" content="Huawei Cloud Knowledge Base" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Bricked ECS After Migration Troubleshooting" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"This blog is a knowledge base created in order to enable faster documentation sharing related to Huawei Cloud.","headline":"Bricked ECS After Migration Troubleshooting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://res-static.hc-cdn.cn/cloudbu-site/intl/en-us/yunying/new-header/logo.png"}},"url":"https://hatz-d.github.io/huaweicloud-knowledge-base/huaweicloud-knowledge-base/docs/migration/sms/bricked-ecs-after-migration-troubleshooting"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/huaweicloud-knowledge-base/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Huawei Cloud Knowledge Base"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Compute category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/compute/" class="nav-list-link">Compute</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Elastic Cloud Server (ECS) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/compute/ecs" class="nav-list-link">Elastic Cloud Server (ECS)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ecs/installing-gui-on-public-linux-images" class="nav-list-link">Installing GUI on Public Linux Images</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ecs/installing-sql-server-ubuntu" class="nav-list-link">Installing SQL Server on Ubuntu</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ecs/remote-login-bricked-error" class="nav-list-link">Remote Login Bricked Error</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ecs/slow-aws-cli-s3-upload-rate-on-windows" class="nav-list-link">Slow AWS CLI S3 Upload Rate on Windows ECSs</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in FunctionGraph category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/compute/functiongraph" class="nav-list-link">FunctionGraph</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/functiongraph/custom-container-image-function" class="nav-list-link">Custom Container Image Function</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/functiongraph/obs-triggered-functions" class="nav-list-link">OBS-triggered Functions</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/functiongraph/pipeline-integration" class="nav-list-link">Pipeline Integration</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Image Management Service (IMS) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/compute/ims" class="nav-list-link">Image Management Service (IMS)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ims/creating-a-private-oracle-os-7-9-image" class="nav-list-link">Creating a Private OracleOS 7.9 Image</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ims/creating-a-private-oracle-os-9-4-image" class="nav-list-link">Creating a Private OracleOS 9.4 Image</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ims/creating-a-private-ubuntu-image" class="nav-list-link">Creating a Private Ubuntu Image</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ims/creating-a-private-windows-10-and-ubuntu-workspace-image" class="nav-list-link">Creating a Private Windows 10 and Ubuntu Workspace Image</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ims/creating-a-private-windows-image" class="nav-list-link">Creating a Private Windows Image</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/compute/ims/migrating-multiple-disks" class="nav-list-link">Migrating Multiple Disks</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Containers category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/containers" class="nav-list-link">Containers</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Cloud Container Engine (CCE) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/containers/cce" class="nav-list-link">Cloud Container Engine (CCE)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/containers/cce/migrating-azure-aks-to-huawei-cce" class="nav-list-link">Migrating Azure AKS to Huawei CCE</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/containers/cce/migrating-k8s-cluster-using-velero" class="nav-list-link">Migrating K8S Cluster Using Velero</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Databases category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/databases" class="nav-list-link">Databases</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Database and Application Migration (UGO) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/databases/ugo" class="nav-list-link">Database and Application Migration (UGO)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/databases/ugo/migrating-mysql-to-gaussdb" class="nav-list-link">Migrating MySQL to GaussDB</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Huawei Cloud Stack category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/huawei-cloud-stack" class="nav-list-link">Huawei Cloud Stack</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Huawei Cloud Stack Online (HCSO) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/huawei-cloud-stack/hcso" class="nav-list-link">Huawei Cloud Stack Online (HCSO)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/huawei-cloud-stack/hcso/terraform-startup" class="nav-list-link">Terraform Startup</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Management & Governance category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/management-and-governance" class="nav-list-link">Management & Governance</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Cloud Eye Service (CES) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/management-and-governance/ces" class="nav-list-link">Cloud Eye Service (CES)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/ces/creating-and-managing-alarms" class="nav-list-link">Creating and Managing Alarms</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/ces/monitoring-data-through-api-calling" class="nav-list-link">Monitoring Data Through API Calling</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/ces/resources-monitoring" class="nav-list-link">Resources Monitoring</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Cloud Operations Center (COC) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/management-and-governance/coc" class="nav-list-link">Cloud Operations Center (COC)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/coc/automate-resources-lifecycle" class="nav-list-link">Automate Resources Lifecycle</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in IAM Identity Center (IIC) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/management-and-governance/iic" class="nav-list-link">IAM Identity Center (IIC)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/iic/user-federation-with-keycloak-saml-2" class="nav-list-link">User Federation with Keycloak (SAML 2.0)</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Identity and Access Management (IAM) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/management-and-governance/iam" class="nav-list-link">Identity and Access Management (IAM)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/iam/user-federation-with-keycloak-openid" class="nav-list-link">User Federation with Keycloak (OpenID)</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/management-and-governance/iam/user-federation-with-keycloak-saml-2" class="nav-list-link">User Federation with Keycloak (SAML 2.0)</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Migration category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/migration" class="nav-list-link">Migration</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Migration Center (MgC) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/migration/mgc" class="nav-list-link">Migration Center (MgC)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration/mgc/resources-discovery" class="nav-list-link">Resources Discovery</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Server Migration Service (SMS) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/migration/sms" class="nav-list-link">Server Migration Service (SMS)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration/sms/bricked-ecs-after-migration-troubleshooting" class="nav-list-link">Bricked ECS After Migration Troubleshooting</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration/sms/failed-to-start-agent-error-quota-is-not-enough" class="nav-list-link">Failed to start agent，error：Current quota is not enough, please use MgC</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration/sms/migrating-servers-with-huge-disks" class="nav-list-link">Migrating Servers with Huge Disks</a></li><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration/sms/migrating-unsupported-os" class="nav-list-link">Migrating Unsupported OSs</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Networking category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/networking" class="nav-list-link">Networking</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Virtual Private Network (VPN) category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/huaweicloud-knowledge-base/docs/networking/vpn" class="nav-list-link">Virtual Private Network (VPN)</a><ul class="nav-list"><li class="nav-list-item"><a href="/huaweicloud-knowledge-base/docs/networking/vpn/vpn-client-to-site-startup" class="nav-list-link">VPN Client to Site Startup</a></li></ul></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Huawei Cloud Knowledge Base" aria-label="Search Huawei Cloud Knowledge Base" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://hatz-d.github.io/huaweicloud-knowledge-base/docs/migration/sms/bricked-ecs-after-migration-troubleshooting" class="site-button">en</a> </li> <li class="aux-nav-list-item"> <a href="https://hatz-d.github.io/huaweicloud-knowledge-base/pt/docs/migration/sms/bricked-ecs-after-migration-troubleshooting" class="site-button">pt</a> </li> </ul> </nav> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/Hatz-D/huaweicloud-knowledge-base" class="site-button" > Contribute </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration">Migration</a></li> <li class="breadcrumb-nav-list-item"><a href="/huaweicloud-knowledge-base/docs/migration/sms">Server Migration Service (SMS)</a></li> <li class="breadcrumb-nav-list-item"><span>Bricked ECS After Migration Troubleshooting</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <p><img width="450px" height="102px" src="https://console-static.huaweicloud.com/static/authui/20210202115135/public/custom/images/logo-en.svg" /></p> <h1 id="bricked-ecs-after-migration-troubleshooting"> <a href="#bricked-ecs-after-migration-troubleshooting" class="anchor-heading" aria-labelledby="bricked-ecs-after-migration-troubleshooting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bricked ECS After Migration Troubleshooting </h1> <p>V1.0 – July 2024</p> <div class="table-wrapper"><table> <thead> <tr> <th><strong>Version</strong></th> <th><strong>Author</strong></th> <th><strong>Description</strong></th> </tr> </thead> <tbody> <tr> <td>V1.0 – 2024-07-30</td> <td>Diogo Hatz 50037923</td> <td>Initial Version</td> </tr> <tr> <td>V1.0 – 2024-07-30</td> <td>Wisley da Silva 00830850</td> <td>Document Review</td> </tr> </tbody> </table></div> <h1 id="introduction"> <a href="#introduction" class="anchor-heading" aria-labelledby="introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction </h1> <p>SMS is a virtual machine migration service provided by Huawei Cloud. With this service, you can migrate VMs from other cloud providers or from on-premises environments to the cloud. SMS migrates virtual machines to ECSs, which correspond to the virtual machine service in Huawei Cloud.</p> <p>This document aims to present a solution for VMs migrated using the SMS migration service in which it is not possible to access the machine through “remote login”, via the console, or via remote access via protocols such as SSH.</p> <h1 id="considerations"> <a href="#considerations" class="anchor-heading" aria-labelledby="considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Considerations </h1> <p><strong><span class="underline">Important:</span></strong> It is possible for several different factors to cause ECSs to freeze after they are migrated via SMS. This document will address the issue of compatibility of certain versions of cloud-init with the ECS service, which is one of the factors that can cause ECS to freeze.</p> <h1 id="symptoms"> <a href="#symptoms" class="anchor-heading" aria-labelledby="symptoms"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Symptoms </h1> <p>When trying to access the ECS via remote login or SSH, the following errors occur:</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image3.png" alt="" /></p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image4.png" alt="" /></p> <h1 id="temporary-ecs"> <a href="#temporary-ecs" class="anchor-heading" aria-labelledby="temporary-ecs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Temporary ECS </h1> <p>Since the ECS cannot be accessed, you will need to remove your system disk and attach it to a temporary ECS in order to access its boot menu. To do this, first create a temporary ECS with the <strong><span class="underline">same operating system</span></strong> and <strong><span class="underline">same AZ</span></strong> as the frozen machine. After that, remove the system disk from the frozen ECS and place it in the temporary ECS as a data disk. Removing the system disk from the frozen ECS:</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image5.png" alt="" /> <img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image6.png" alt="" /> <img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image7.png" alt="" /></p> <p>Attaching the system disk from the frozen ECS to the temporary ECS as a data disk data:</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image8.png" alt="" /></p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image9.png" alt="" /></p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image10.png" alt="" /></p> <p>After that, remotely access the temporary ECS and use the “fdisk -l” command to list the disks attached to the machine.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image11.png" alt="" /></p> <p>When you identify the disk that was attached to the temporary ECS, mount the disk with the mount command. For example: “mount /dev/vdb1 /mnt”.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image12.png" alt="" /></p> <p>Once the mount is complete, perform the following steps:</p> <ol> <li> <blockquote> <p>Delete the grub configuration file with the command:</p> </blockquote> </li> </ol> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> /mnt/boot/grub/grub.cfg
</code></pre></div></div> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image13.png" alt="" /></p> <ol> <li> <blockquote> <p>Copy the generic kernel from the temporary ECS to the /boot directory of the frozen ECS:</p> </blockquote> </li> </ol> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> /boot/vmlinuz-5.4.0-170-generic /mnt/boot/vmlinuz-5.4.0-170-generic
</code></pre></div></div> <p><strong><span class="underline">Important:</span></strong> The kernel name used was just an example; it is necessary to copy the kernel used by the temporary ECS. If in doubt, use the “uname -r” command to list the running kernel version.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image14.png" alt="" /></p> <ol> <li> <blockquote> <p>Copy the initrd from the temporary ESC to the /boot directory of the frozen ECS:</p> </blockquote> </li> </ol> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> /boot/initrd.img-5.4.0-170-generic /mnt/boot/initrd.img-5.4.0-170-generic
</code></pre></div></div> <p><strong><span class="underline">Important:</span></strong> Copy the initrd for the kernel copied in step 2.0. If there is no initrd, generate one with the “update-initramfs -u” command.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image15.png" alt="" /></p> <p>Remove the data disk with the command “umount /dev/vdb1”.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image16.png" alt="" /></p> <p>Once done, put the frozen ECS system disk back into the original ECS, following the step-by-step instructions in item 4.0 of this document. Once done, start the machine and “remotely log in” to it via the console.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image17.png" alt="" /></p> <h1 id="grub-shell"> <a href="#grub-shell" class="anchor-heading" aria-labelledby="grub-shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Grub shell </h1> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image18.png" alt="" /></p> <p>Run the “ls” command to list the disk partitions seen by Grub. To identify which is the correct partition to use, run the “ls (hd0,gpt1)/” command until you find the partition with the contents of the system disk, replacing “hd0,gpt1” with the partitions seen by the “ls”.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image19.png" alt="" /></p> <p>Once you find the correct partition, perform the following steps to boot the temporary ECS kernel in single-user mode:</p> <ol> <li>Replacing (hd0,gpt1) with the partition found above; <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">set </span><span class="nv">root</span><span class="o">=(</span>hd0,gpt1<span class="o">)</span>
</code></pre></div> </div> </li> <li>Replacing “vmlinuz-5.4.0-170-generic” with the kernel copied from the temporary ECS in item 4.0 of this document and replacing “vda1” according to the partition found. <strong><span class="underline">Example:</span></strong> (hd0,gp1) = vda1, (hd1,gpt1) = vdb1, (hd3,gpt2) = /dev/vdd2, and so on; <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>linux /boot/vmlinuz-5.4.0-170-generic <span class="nv">root</span><span class="o">=</span>/dev/vda1 ro single
</code></pre></div> </div> </li> <li>Replacing “initrd.img-5.4.0-170-generic” with the initrd copied from the temporary ECS in item 4.0 of this document; <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>initrd /boot/initrd.img-5.4.0-170-generic
</code></pre></div> </div> </li> <li>Finish booting. <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>boot
</code></pre></div> </div> </li> </ol> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image20.png" alt="" /></p> <p>After entering the boot command, the ECS will boot in single-user mode. Enter the ECS root password when prompted.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image21.png" alt="" /></p> <h1 id="single-user"> <a href="#single-user" class="anchor-heading" aria-labelledby="single-user"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Single-user </h1> <p>Use the “apt-get remove cloud-init -y” command to uninstall cloud-init.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image22.png" alt="" /></p> <p>Use the “update-grub” command to generate the previously deleted grub configuration file.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image23.png" alt="" /></p> <p>Use the command “grep ‘menuentry ‘ /boot/grub/grub.cfg” to list the kernel versions on the system and copy the desired version so that Grub will boot by default.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image24.png" alt="" /></p> <p>Use the command “vim /etc/default/grub” to modify the grub configuration file. Change the parameters grub_default={kernel name copied above}, “grub_timeout_style=menu” and “grub_timeout=10”.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image25.png" alt="" /></p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image26.png" alt="" /></p> <p>Use the “update-grub” command to update the grub configuration file again.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image23.png" alt="" /></p> <p>Use the “reboot” command to restart the ECS. Note that the machine will now boot normally.</p> <h1 id="configurations"> <a href="#configurations" class="anchor-heading" aria-labelledby="configurations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configurations </h1> <p>Check the ECS connectivity with the “ip a” command. If the ECS does not have the eth0 interface configured correctly, there may be a conflict in the netplan program configuration. If the ECS has normal connectivity, skip section 7.1 of this document.</p> <h2 id="netplan"> <a href="#netplan" class="anchor-heading" aria-labelledby="netplan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Netplan</strong> </h2> <p>Type the command “vim /etc/netplan/50-cloud-init.yaml” to open the ECS network configuration file and add the eth0 interface as follows:</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image27.png" alt="" /></p> <p>Once done, apply the settings made with the “netplan apply” command</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image28.png" alt="" /></p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image29.png" alt="" /></p> <p>If connectivity has not yet returned to normal, check the installation of the drivers KVM from the following documentation: <a href="https://support.huaweicloud.com/intl/en-us/usermanual-ims/ims_01_0326.html#ims_01_0326__section1865536911274">https://support.huaweicloud.com/intl/en-us/usermanual-ims/ims_01_0326.html#ims_01_0326__section1865536911274</a>.</p> <h2 id="config"> <a href="#config" class="anchor-heading" aria-labelledby="config"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Config </h2> <p>If the VM was migrated from Azure, you will need to change the machine’s Yum repositories to point to the Huawei repository:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/azure.archive.ubuntu.com/repo.huaweicloud.com/g'</span> /etc/apt/sources.list

apt autoclean <span class="o">&amp;&amp;</span> apt update
</code></pre></div></div> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image30.png" alt="" /></p> <p>Once you have changed the repositories, reinstall cloud-init with the command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get <span class="nb">install </span>cloud-init
</code></pre></div></div> <p><strong><span class="underline">Important:</span></strong> Do not install version 23.3.3 of cloud-init.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image31.png" alt="" /></p> <p>Install a new version of the Linux kernel with the command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get <span class="nb">install </span>linux-image-generic
</code></pre></div></div> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image32.png" alt="" /></p> <p>Use the command “grep ‘menuentry ‘ /boot/grub/grub.cfg” to list the kernel versions on the system and copy the latest installed version.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image33.png" alt="" /></p> <p>Use the command “vim /etc/default/grub” to modify the grub configuration file. Change the parameters grub_default={kernel name copied above}. <img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image34.png" alt="" /></p> <p>Use the “update-grub” command to update the grub configuration file again.</p> <p><img src="/huaweicloud-knowledge-base/assets/images/migration/sms/bricked-ecs-after-migration/image35.png" alt="" /></p> <p>Use the “reboot” command to restart ECS on the updated kernel.</p> <h1 id="settings-optional"> <a href="#settings-optional" class="anchor-heading" aria-labelledby="settings-optional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Settings (Optional) </h1> <p>In addition to the above settings, it is also recommended that the Azure agent, which is installed by default on Azure VMs, be uninstalled, since the agent constantly reports logs to the VNC console, which may affect VNC performance:</p> <p>Enter the following command to uninstall the Azure agent:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nt">-y</span> remove walinuxagent
apt-get remove <span class="nt">-y</span> linux-azure-<span class="k">*</span>
apt-get remove <span class="nt">-y</span> <span class="k">*</span>azure
</code></pre></div></div> <h1 id="references"> <a href="#references" class="anchor-heading" aria-labelledby="references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h1> <ul> <li>Installing KVM drivers: <a href="https://support.huaweicloud.com/intl/en-us/usermanual-ims/ims_01_0326.html#ims_01_0326__section1865536911274">https://support.huaweicloud.com/intl/en-us/usermanual-ims/ims_01_0326.html#ims_01_0326__section1865536911274</a>.</li> </ul> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
